!function(e){return e.dateRangePickerLanguages={cn:{selected:"已选择:",day:"天",days:"天",apply:"确定","week-1":"一","week-2":"二","week-3":"三","week-4":"四","week-5":"五","week-6":"六","week-7":"日","month-name":["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],shortcuts:"快捷选择",past:"过去",following:"将来",previous:"&nbsp;&nbsp;&nbsp;","prev-week":"上周","prev-month":"上个月","prev-year":"去年",next:"&nbsp;&nbsp;&nbsp;","next-week":"下周","next-month":"下个月","next-year":"明年","less-than":"所选日期范围不能大于%d天","more-than":"所选日期范围不能小于%d天","default-more":"请选择大于%d天的日期范围","default-less":"请选择小于%d天的日期范围","default-range":"请选择%d天到%d天的日期范围","default-default":"请选择一个日期范围"},en:{selected:"Selected:",day:"Day",days:"Days",apply:"Close","week-1":"MO","week-2":"TU","week-3":"WE","week-4":"TH","week-5":"FR","week-6":"SA","week-7":"SU","month-name":["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],shortcuts:"Shortcuts",past:"Past",following:"Following",previous:"Previous","prev-week":"Week","prev-month":"Month","prev-year":"Year",next:"Next","next-week":"Week","next-month":"Month","next-year":"Year","less-than":"Date range should not be more than %d days","more-than":"Date range should not be less than %d days","default-more":"Please select a date range longer than %d days","default-less":"Please select a date range less than %d days","default-range":"Please select a date range between %d and %d days","default-default":"Please select a date range"}},void 0===window.moment?void alert("Please import moment.js before daterangepicker.js"):void(e.fn.dateRangePicker=function(t){function a(e,t){var a=parseInt(moment(e).format("YYYYMM"))-parseInt(moment(t).format("YYYYMM"));return a>0?1:0==a?0:-1}function n(e,t){var a=parseInt(moment(e).format("YYYYMMDD"))-parseInt(moment(t).format("YYYYMMDD"));return a>0?1:0==a?0:-1}function s(e){e=moment(e).toDate();for(var t=e.getMonth();e.getMonth()==t;)e=new Date(e.getTime()+864e5);return e}function r(e){e=moment(e).toDate();for(var t=e.getMonth();e.getMonth()==t;)e=new Date(e.getTime()-864e5);return e}function d(){var a='<div class="date-picker-wrapper"><div class="top-bar">         <div class="normal-top">            <span style="color:#333">'+c("selected")+' </span> <b class="start-day">...</b> '+t.separator+' <b class="end-day">...</b> <i class="selected-days">(<span class="selected-days-num">3</span> '+c("days")+')</i>          </div>          <div class="error-top">error</div>          <div class="default-top">default</div>          <input type="button" class="apply-btn disabled" value="'+c("apply")+'" />       </div><div class="month-wrapper"><table class="month1" cellspacing="0" border="0" cellpadding="0"><thead><tr class="caption"><th style="width:27px;"><span class="prev">&lt;</span></th><th colspan="5" class="month-name">January, 2011</th><th style="width:27px;"><span class="next">&gt;</span></th></tr><tr class="week-name">'+o()+'</thead><tbody></tbody></table><div class="gap">'+i()+'</div><table class="month2" cellspacing="0" border="0" cellpadding="0"><thead><tr class="caption"><th style="width:27px;"><span class="prev">&lt;</span></th><th colspan="5" class="month-name">January, 2011</th><th style="width:27px;"><span class="next">&gt;</span></th></tr><tr class="week-name">'+o()+'</thead><tbody></tbody></table><div style="clear:both;height:0;font-size:0;"></div></div>';if(t.showShortcuts){a+='<div class="footer"><b>'+c("shortcuts")+"</b>";var n=t.shortcuts;if(n){if(n["prev-days"]&&n["prev-days"].length>0){a+='&nbsp;<span class="prev-days">'+c("past");for(var s=0;s<n["prev-days"].length;s++){var r=n["prev-days"][s];r+=c(n["prev-days"][s]>1?"days":"day"),a+=' <a href="javascript:;" shortcut="day,-'+n["prev-days"][s]+'">'+r+"</a>"}a+="</span>"}if(n["next-days"]&&n["next-days"].length>0){a+='&nbsp;<span class="next-days">'+c("following");for(var s=0;s<n["next-days"].length;s++){var r=n["next-days"][s];r+=c(n["next-days"][s]>1?"days":"day"),a+=' <a href="javascript:;" shortcut="day,'+n["next-days"][s]+'">'+r+"</a>"}a+="</span>"}if(n.prev&&n.prev.length>0){a+='&nbsp;<span class="prev-buttons">'+c("previous");for(var s=0;s<n.prev.length;s++){var r=c("prev-"+n.prev[s]);a+=' <a href="javascript:;" shortcut="prev,'+n.prev[s]+'">'+r+"</a>"}a+="</span>"}if(n.next&&n.next.length>0){a+='&nbsp;<span class="next-buttons">'+c("next");for(var s=0;s<n.next.length;s++){var r=c("next-"+n.next[s]);a+=' <a href="javascript:;" shortcut="next,'+n.next[s]+'">'+r+"</a>"}a+="</span>"}}if(t.customShortcuts)for(var s=0;s<t.customShortcuts.length;s++){var d=t.customShortcuts[s];a+='&nbsp;<span class="custom-shortcut"><a href="javascript:;" shortcut="custom">'+d.name+"</a></span>"}a+="</div>"}return a+="</div>",e(a)}function o(){return"monday"==t.startOfWeek?"<th>"+c("week-1")+"</th>         <th>"+c("week-2")+"</th>          <th>"+c("week-3")+"</th>          <th>"+c("week-4")+"</th>          <th>"+c("week-5")+"</th>          <th>"+c("week-6")+"</th>          <th>"+c("week-7")+"</th>":"<th>"+c("week-7")+"</th>         <th>"+c("week-1")+"</th>          <th>"+c("week-2")+"</th>          <th>"+c("week-3")+"</th>          <th>"+c("week-4")+"</th>          <th>"+c("week-5")+"</th>          <th>"+c("week-6")+"</th>"}function i(){for(var e=['<div class="gap-top-mask"></div><div class="gap-bottom-mask"></div><div class="gap-lines">'],t=0;13>t;t++)e.push('<div class="gap-line">         <div class="gap-1"></div>         <div class="gap-2"></div>         <div class="gap-3"></div>       </div>');return e.push("</div>"),e.join("")}function l(e){var a=[];e.setDate(1);var s=(new Date(e.getTime()-864e5),new Date);if(e.getDay()>0)for(var r=e.getDay();r>0;r--){var d=new Date(e.getTime()-864e5*r),o=!0;t.startDate&&n(d,t.startDate)<0&&(o=!1),t.endDate&&n(d,t.endDate)>0&&(o=!1),a.push({type:"lastMonth",day:d.getDate(),time:d.getTime(),valid:o})}for(var i=e.getMonth(),r=0;40>r;r++){var l=moment(e).add("days",r).toDate(),o=!0;t.startDate&&n(l,t.startDate)<0&&(o=!1),t.endDate&&n(l,t.endDate)>0&&(o=!1),a.push({type:l.getMonth()==i?"toMonth":"nextMonth",day:l.getDate(),time:l.getTime(),valid:o})}for(var h=[],c=0;6>c&&"nextMonth"!=a[7*c].type;c++){h.push("<tr>");for(var d=0;7>d;d++){var p="monday"==t.startOfWeek?d+1:d,l=a[7*c+p],m=moment(l.time).format("L")==moment(s).format("L");h.push('<td><div time="'+l.time+'" class="day '+l.type+" "+(l.valid?"valid":"invalid")+" "+(m?"real-today":"")+'">'+l.day+"</div></td>")}h.push("</tr>")}return h.join("")}function h(){if("auto"==t.language){var a=navigator.language?navigator.language:navigator.browserLanguage;if(!a)return e.dateRangePickerLanguages.en;var a=a.toLowerCase();for(var n in e.dateRangePickerLanguages)if(-1!=a.indexOf(n))return e.dateRangePickerLanguages[n];return e.dateRangePickerLanguages.en}return t.language&&t.language in e.dateRangePickerLanguages?e.dateRangePickerLanguages[t.language]:e.dateRangePickerLanguages.en}function c(e){return e in m?m[e]:e}t||(t={}),t=e.extend({autoClose:!1,format:"YYYY-MM-DD",separator:" to ",language:"auto",startOfWeek:"sunday",getValue:function(){return this.value},setValue:function(e){this.value=e},startDate:!1,endDate:!1,minDays:0,maxDays:0,showShortcuts:!0,shortcuts:{"next-days":[3,5,7],next:["week","month","year"]},customShortcuts:[]},t),t.start=!1,t.end=!1,t.startDate&&"string"==typeof t.startDate&&(t.startDate=moment(t.startDate,t.format).toDate()),t.endDate&&"string"==typeof t.endDate&&(t.endDate=moment(t.endDate,t.format).toDate());var p,m=h();return e(this).unbind(".datepicker").bind("click.datepicker",function(o){function i(e){if(!e.hasClass("invalid")){var a=e.attr("time");if(e.addClass("checked"),t.start&&t.end||!t.start&&!t.end?(t.start=a,t.end=!1):t.start&&(t.end=a),t.start&&t.end&&t.start>t.end){var n=t.end;t.end=t.start,t.start=n}t.start=parseInt(t.start),t.end=parseInt(t.end),h(),m(),f()}}function h(){var e=Math.ceil((t.end-t.start)/864e5)+1;t.maxDays&&e>t.maxDays?(t.start=!1,t.end=!1,p.find(".day").removeClass("checked"),p.find(".top-bar").removeClass("normal").addClass("error").find(".error-top").html(c("less-than").replace("%d",t.maxDays))):t.minDays&&e<t.minDays?(t.start=!1,t.end=!1,p.find(".day").removeClass("checked"),p.find(".top-bar").removeClass("normal").addClass("error").find(".error-top").html(c("more-than").replace("%d",t.minDays))):t.start||t.end?p.find(".top-bar").removeClass("error").addClass("normal"):p.find(".top-bar").removeClass("error").removeClass("normal"),t.start&&t.end?p.find(".apply-btn").removeClass("disabled"):p.find(".apply-btn").addClass("disabled")}function m(){if(p.find(".start-day").html("..."),p.find(".end-day").html("..."),p.find(".selected-days").hide(),t.start&&p.find(".start-day").html(y(new Date(parseInt(t.start)))),t.end&&p.find(".end-day").html(y(new Date(parseInt(t.end)))),t.start&&t.end){p.find(".selected-days").show().find(".selected-days-num").html(Math.round((t.end-t.start)/864e5)+1),p.find(".apply-btn").removeClass("disabled");var a=y(new Date(t.start))+t.separator+y(new Date(t.end));t.setValue.call(b,a,y(new Date(t.start)),y(new Date(t.end))),k&&(e(b).trigger("datepicker-change",{value:a,date1:new Date(t.start),date2:new Date(t.end)}),t.autoClose&&w())}else p.find(".apply-btn").addClass("disabled")}function u(e,r){if(e.getTime()>r.getTime()){var d=r;r=e,e=d,d=null}var o=!0;return t.startDate&&n(e,t.startDate)<0&&(o=!1),t.endDate&&n(r,t.endDate)>0&&(o=!1),o?(t.start=e.getTime(),t.end=r.getTime(),0==a(e,r)&&(r=s(e)),v(e,"month1"),v(r,"month2"),D(),void m()):(v(t.startDate,"month1"),v(s(t.startDate),"month2"),void D())}function f(){(t.start||t.end)&&p.find(".day").each(function(){if(e(this).hasClass("toMonth")){var a=e(this).attr("time");t.start&&t.end&&t.end>=a&&t.start<=a||t.start&&!t.end&&t.start==a?e(this).addClass("checked"):e(this).removeClass("checked")}})}function v(e,a){e=moment(e).toDate();var n=g(e.getMonth());p.find("."+a+" .month-name").html(n+" "+e.getFullYear()),p.find("."+a+" tbody").html(l(e)),t[a]=e}function g(e){return c("month-name")[e]}function y(e){return moment(e).format(t.format)}function D(){f();var e=parseInt(moment(t.month1).format("YYYYMM")),a=parseInt(moment(t.month2).format("YYYYMM")),n=Math.abs(e-a),s=n>1&&89!=n;s?p.find(".gap").show():p.find(".gap").hide()}function w(){e(p).slideUp(200,function(){p.remove(),e(b).data("date-picker-openned",!1)}),e(document).unbind(".datepicker"),e(b).trigger("datepicker-close")}var k=!1;o.stopPropagation();var b=this;if(e(this).data("date-picker-openned"))return void w();e(this).data("date-picker-openned",!0),p=d().hide(),e(document.body).append(p);var x=e(this).offset();p.css(x.left<460?{top:x.top+e(this).outerHeight()+parseInt(0+e("body").css("border-top"),10),left:x.left}:{top:x.top+e(this).outerHeight()+parseInt(0+e("body").css("border-top"),10),left:x.left+e(b).width()-p.width()-16});var M=new Date;t.startDate&&a(M,t.startDate)<0&&(M=moment(t.startDate).toDate()),t.endDate&&a(s(M),t.endDate)>0&&(M=r(moment(t.endDate).toDate())),v(M,"month1"),v(s(M),"month2"),p.slideDown(200);var Y="";Y=c(t.minDays&&t.maxDays?"default-range":t.minDays?"default-more":t.maxDays?"default-less":"default-default"),p.find(".default-top").html(Y.replace(/\%d/,t.minDays).replace(/\%d/,t.maxDays));var C=t.getValue.call(b).split(t.separator);if(C&&C.length>=2){var T=t.format;T.match(/Do/)&&(T=T.replace(/Do/,"D"),C[0]=C[0].replace(/(\d+)(th|nd|st)/,"$1"),C[1]=C[1].replace(/(\d+)(th|nd|st)/,"$1")),u(moment(C[0],T).toDate(),moment(C[1],T).toDate())}setTimeout(function(){k=!0},0),p.click(function(e){e.stopPropagation()}),e(document).unbind(".datepicker").bind("click.datepicker",function(){w()}),p.find(".next").click(function(){var n=e(this).parents("table").hasClass("month2"),r=n?t.month2:t.month1;r=s(r),!n&&a(r,t.month2)>=0||(v(r,n?"month2":"month1"),D())}),p.find(".prev").click(function(){var n=e(this).parents("table").hasClass("month2"),s=n?t.month2:t.month1;s=r(s),n&&a(s,t.month1)<=0||(v(s,n?"month2":"month1"),D())}),p.bind("click",function(t){e(t.target).hasClass("day")&&e(t.target).hasClass("toMonth")&&i(e(t.target))}),p.attr("unselectable","on").css("user-select","none").bind("selectstart",function(e){return e.preventDefault(),!1}),p.find(".apply-btn").click(function(){w();var a=y(new Date(t.start))+t.separator+y(new Date(t.end));e(b).trigger("datepicker-apply",{value:a,date1:new Date(t.start),date2:new Date(t.end)})}),p.find("[shortcut]").click(function(){var a=e(this).attr("shortcut"),n=new Date,d=!1;if(-1!=a.indexOf("day")){var o=parseInt(a.split(",",2)[1],10);d=new Date((new Date).getTime()+864e5*o),n=new Date(n.getTime()+864e5*(o>0?1:-1))}else if(-1!=a.indexOf("week")){var i=-1!=a.indexOf("prev,")?-1:1;if(1==i)var l="monday"==t.startOfWeek?1:0;else var l="monday"==t.startOfWeek?0:6;for(n=new Date(n.getTime()-864e5);n.getDay()!=l;)n=new Date(n.getTime()+864e5*i);d=new Date(n.getTime()+864e5*i*6)}else if(-1!=a.indexOf("month")){var i=-1!=a.indexOf("prev,")?-1:1;d=1==i?s(n):r(n),d.setDate(1),n=s(d),n.setDate(1),n=new Date(n.getTime()-864e5)}else if(-1!=a.indexOf("year")){var i=-1!=a.indexOf("prev,")?-1:1;d=new Date,d.setFullYear(n.getFullYear()+i),d.setMonth(0),d.setDate(1),n.setFullYear(n.getFullYear()+i),n.setMonth(11),n.setDate(31)}else if("custom"==a){var c=e(this).html();if(t.customShortcuts&&t.customShortcuts.length>0)for(var p=0;p<t.customShortcuts.length;p++){var m=t.customShortcuts[p];if(m.name==c){var f=[];f=m.dates.call(),f&&2==f.length&&(d=f[0],n=f[1]),f&&1==f.length&&(movetodate=f[0],v(movetodate,"month1"),v(s(movetodate),"month2"),D());break}}}d&&n&&(u(d,n),h())})}),this})}(jQuery);
